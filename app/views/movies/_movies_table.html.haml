- require 'open-uri'
%table.table.table-striped
  %tbody
    - movies.each_with_index do |movie, i|
      %tr
        %td= i + 1
        %td
          %img.img-rounded{ src: (f = open("https://pairguru-api.herokuapp.com/api/v1/movies/#{URI.encode(movie.title)}") and api_data = eval(f.read)[:data][:attributes] and "https://pairguru-api.herokuapp.com#{api_data[:poster]}"), width:100}
        %td
          %h4
            = link_to movie.title, movie_path(movie)
          %p
            %strong
              = link_to movie.genre.name, movies_genre_path(movie.genre)
            = ' (' + movie.released_at.to_s + ')'
          %p= api_data[:plot]
          %p= "Rating: #{api_data[:rating]}"